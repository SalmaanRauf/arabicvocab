# UX Phase 1 (Shell + Home + Daily) Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Implement the Phase 1 UX update: bottom-nav shell, new Home dashboard, and refreshed Daily Lesson view while keeping Quran/Review/Progress accessible.

**Architecture:** Introduce a bottom-navigation shell via `StatefulShellRoute`. Rework Home into a dashboard hub and move the Surah list into a new Quran hub view. Update Daily Lesson layout to match the UX spec. Refresh theme tokens to the new calm/reverent palette.

**Tech Stack:** Flutter, Riverpod, GoRouter, shared_preferences, Google Fonts.

---

## Baseline Verification
**Note:** Flutter tests currently crash with:
`../../runtime/vm/cpuinfo_macos.cc: 42: error: unreachable code` when running `/Users/salmaanrauf/Documents/arabicapp/arabicvocab/tools/flutter/bin/flutter test`.
Proceeding requires either using a working Flutter install or accepting that baseline tests cannot be verified in this environment.

---

### Task 1: Add Bottom-Nav Shell

**Files:**
- Create: `quran_vocab/lib/presentation/widgets/app_shell.dart`
- Modify: `quran_vocab/lib/presentation/routes/app_router.dart`
- Test: `quran_vocab/test/nav_shell_test.dart`

**Step 1: Write the failing test**
Create `nav_shell_test.dart` to assert:
- Bottom nav shows 5 items: Home, Quran, Daily, Review, Progress
- App launches into Home tab by default

**Step 2: Run test to verify it fails**
Run: `/Users/salmaanrauf/Documents/arabicapp/arabicvocab/tools/flutter/bin/flutter test test/nav_shell_test.dart`
Expected: FAIL (shell not implemented)

**Step 3: Write minimal implementation**
- Add `AppShell` with `Scaffold` and `NavigationBar`
- Use `StatefulShellRoute` in `AppRouter` for 5 branches
- Wire branches to Home/Quran/Daily/Review/Progress routes

**Step 4: Run test to verify it passes**
Run same test, expect PASS

**Step 5: Commit**
`git add ...` then `git commit -m "feat: add bottom nav shell"`

---

### Task 2: Create Quran Hub + Update Home Dashboard

**Files:**
- Create: `quran_vocab/lib/presentation/views/quran_hub_view.dart`
- Modify: `quran_vocab/lib/presentation/views/home_view.dart`
- Test: `quran_vocab/test/home_view_test.dart`

**Step 1: Write the failing test**
Create `home_view_test.dart` to assert:
- Home shows “Today’s Lesson”
- Home shows “Continue Reading”
- Home shows “Quick Actions” grid

**Step 2: Run test to verify it fails**
Run: `/Users/salmaanrauf/Documents/arabicapp/arabicvocab/tools/flutter/bin/flutter test test/home_view_test.dart`
Expected: FAIL

**Step 3: Write minimal implementation**
- Rebuild `HomeView` as dashboard layout (per UX docs)
- Move existing surah list into new `QuranHubView`
- Ensure `QuranHubView` includes search, tabs placeholder, and surah list

**Step 4: Run test to verify it passes**
Run same test, expect PASS

**Step 5: Commit**
`git commit -m "feat: add home dashboard and quran hub"`

---

### Task 3: Refresh Daily Lesson Layout

**Files:**
- Modify: `quran_vocab/lib/presentation/views/daily_lesson_view.dart`
- Test: `quran_vocab/test/daily_lesson_view_test.dart`

**Step 1: Write the failing test**
Update `daily_lesson_view_test.dart` to assert:
- Header includes Day # + Streak
- Reflection section exists with “Read more”
- Takeaways and Source sections render

**Step 2: Run test to verify it fails**
Run: `/Users/salmaanrauf/Documents/arabicapp/arabicvocab/tools/flutter/bin/flutter test test/daily_lesson_view_test.dart`
Expected: FAIL

**Step 3: Write minimal implementation**
- Align layout to spec (Header card, Actions, Audio card, Verse section, Reflection, Takeaways, Source, History)
- Ensure text and button labels match UX copy

**Step 4: Run test to verify it passes**
Run same test, expect PASS

**Step 5: Commit**
`git commit -m "feat: refine daily lesson layout"`

---

### Task 4: Update Theme Tokens

**Files:**
- Modify: `quran_vocab/lib/presentation/theme/app_theme.dart`
- Modify: `quran_vocab/test/app_theme_test.dart`

**Step 1: Write the failing test**
Update `app_theme_test.dart` to assert new background colors:
- Light: `#F7F4EF`
- Dark: `#141413`

**Step 2: Run test to verify it fails**
Run: `/Users/salmaanrauf/Documents/arabicapp/arabicvocab/tools/flutter/bin/flutter test test/app_theme_test.dart`
Expected: FAIL

**Step 3: Write minimal implementation**
- Update `AppTheme` color scheme to new tokens
- Ensure typography uses `Sora` for headings and `Lora` for body

**Step 4: Run test to verify it passes**
Run same test, expect PASS

**Step 5: Commit**
`git commit -m "feat: update theme tokens for new UX"`

---

## Test Plan
- `test/nav_shell_test.dart`
- `test/home_view_test.dart`
- `test/daily_lesson_view_test.dart`
- `test/app_theme_test.dart`
- (If Flutter VM issue persists, run locally with working Flutter install)

## Assumptions
- Phase 1 includes only shell + Home + Daily UX updates; Quran/Review/Progress remain functional without full redesign.
- `StatefulShellRoute` is acceptable for navigation.
- Existing Daily Lesson data and providers remain unchanged.

---

## Execution Options (per writing-plans)
1. **Subagent-Driven (this session)** — use superpowers:subagent-driven-development
2. **Parallel Session (separate)** — open new session with superpowers:executing-plans
