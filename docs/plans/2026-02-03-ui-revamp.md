# Quranic Vocabulary UI Revamp Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Apply a full UI revamp with a global light/dark toggle using the Warm Noir + Parchment design system, and update all major screens to match.

**Architecture:** Centralize theme tokens in `AppTheme` and a global `ThemeMode` provider. Apply design updates per screen using shared theme values and updated widget styling (cards, buttons, list tiles, headers).

**Tech Stack:** Flutter Web, Dart, Riverpod, google_fonts.

---

### Task 1: Add global theme mode state + test

**Files:**
- Modify: `quran_vocab/lib/presentation/state/settings_providers.dart`
- Modify: `quran_vocab/lib/app.dart`
- Test: `quran_vocab/test/theme_mode_provider_test.dart`

**Step 1: Write the failing test**

```dart
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:quran_vocab/presentation/state/settings_providers.dart';

void main() {
  test('themeModeProvider defaults to light', () {
    final container = ProviderContainer();
    addTearDown(container.dispose);
    expect(container.read(themeModeProvider), ThemeMode.light);
  });
}
```

**Step 2: Run test to verify it fails**

Run:
```
/Users/salmaanrauf/Documents/arabicapp/arabicvocab/tools/flutter/bin/flutter test test/theme_mode_provider_test.dart
```

Expected: FAIL (provider missing).

**Step 3: Write minimal implementation**

```dart
final themeModeProvider = StateProvider<ThemeMode>((ref) => ThemeMode.light);
```

Update `app.dart` to read `themeModeProvider` and set `themeMode` in `MaterialApp.router`.

**Step 4: Run test to verify it passes**

Run:
```
/Users/salmaanrauf/Documents/arabicapp/arabicvocab/tools/flutter/bin/flutter test test/theme_mode_provider_test.dart
```

Expected: PASS

**Step 5: Commit**

```
git add quran_vocab/lib/presentation/state/settings_providers.dart quran_vocab/lib/app.dart quran_vocab/test/theme_mode_provider_test.dart
git commit -m "feat: add global theme mode"
```

---

### Task 2: Implement Warm Noir + Parchment ThemeData

**Files:**
- Modify: `quran_vocab/lib/presentation/theme/app_theme.dart`
- Test: `quran_vocab/test/app_theme_test.dart`

**Step 1: Write the failing test**

```dart
import 'package:flutter/material.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:quran_vocab/presentation/theme/app_theme.dart';

void main() {
  test('AppTheme.light uses parchment background', () {
    final theme = AppTheme.light();
    expect(theme.scaffoldBackgroundColor, const Color(0xFFFAF9F5));
  });

  test('AppTheme.dark uses warm noir background', () {
    final theme = AppTheme.dark();
    expect(theme.scaffoldBackgroundColor, const Color(0xFF141413));
  });
}
```

**Step 2: Run test to verify it fails**

Run:
```
/Users/salmaanrauf/Documents/arabicapp/arabicvocab/tools/flutter/bin/flutter test test/app_theme_test.dart
```

Expected: FAIL (no dark theme, wrong colors).

**Step 3: Write minimal implementation**

- Add `AppTheme.dark()` with Warm Noir palette.
- Update `AppTheme.light()` to Parchment palette.
- Apply Poppins for headings and Lora for body via `google_fonts`.
- Set `cardTheme`, `inputDecorationTheme`, `appBarTheme`, `buttonTheme`.

**Step 4: Run tests**

Run:
```
/Users/salmaanrauf/Documents/arabicapp/arabicvocab/tools/flutter/bin/flutter test test/app_theme_test.dart
```

Expected: PASS

**Step 5: Commit**

```
git add quran_vocab/lib/presentation/theme/app_theme.dart quran_vocab/test/app_theme_test.dart
git commit -m "feat: add warm noir and parchment themes"
```

---

### Task 3: Add theme toggle to Settings

**Files:**
- Modify: `quran_vocab/lib/presentation/views/settings_view.dart`
- Test: `quran_vocab/test/settings_theme_toggle_test.dart`

**Step 1: Write failing widget test**

```dart
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:quran_vocab/presentation/views/settings_view.dart';

void main() {
  testWidgets('Settings shows theme toggle', (tester) async {
    await tester.pumpWidget(
      const ProviderScope(
        child: MaterialApp(home: SettingsView()),
      ),
    );
    expect(find.text('Appearance'), findsOneWidget);
    expect(find.byType(Switch), findsOneWidget);
  });
}
```

**Step 2: Run test to verify it fails**

Run:
```
/Users/salmaanrauf/Documents/arabicapp/arabicvocab/tools/flutter/bin/flutter test test/settings_theme_toggle_test.dart
```

Expected: FAIL (toggle not present).

**Step 3: Implement toggle**

- Add an “Appearance” section with a `SwitchListTile`.
- Bind to `themeModeProvider`.

**Step 4: Run test**

Expected: PASS

**Step 5: Commit**

```
git add quran_vocab/lib/presentation/views/settings_view.dart quran_vocab/test/settings_theme_toggle_test.dart
git commit -m "feat: add theme toggle to settings"
```

---

### Task 4: Update shared components (WordChip + AyahWidget)

**Files:**
- Modify: `quran_vocab/lib/presentation/widgets/word_chip.dart`
- Modify: `quran_vocab/lib/presentation/widgets/ayah_widget.dart`

**Step 1: Update WordChip to use theme colors**
- Use `onSurface`/`onSurfaceVariant` for text.
- Highlight uses fill + border + font weight bump (no neon).

**Step 2: Update AyahWidget container styling**
- Use card‑like styling consistent with new theme.
- Reduce visual noise in header row.

**Step 3: Commit**

```
git add quran_vocab/lib/presentation/widgets/word_chip.dart quran_vocab/lib/presentation/widgets/ayah_widget.dart
git commit -m "feat: restyle ayah and word components"
```

---

### Task 5: Revamp major screens

**Files:**
- Modify: `quran_vocab/lib/presentation/views/home_view.dart`
- Modify: `quran_vocab/lib/presentation/views/reader_view.dart`
- Modify: `quran_vocab/lib/presentation/views/dashboard_view.dart`
- Modify: `quran_vocab/lib/presentation/views/review_view.dart`
- Modify: `quran_vocab/lib/presentation/views/curriculum_view.dart`
- Modify: `quran_vocab/lib/presentation/views/lesson_detail_view.dart`

**Step 1: HomeView**
- Hero section with warm gradient band (both modes).
- Surah list as cards with hairline borders.

**Step 2: ReaderView**
- Distinctive header card, low‑noise UI.
- Audio card and surah picker consistent with theme.

**Step 3: Dashboard / Review / Curriculum**
- Use consistent card styling + typography.
- Replace hardcoded bright colors with theme tints.

**Step 4: Commit**

```
git add quran_vocab/lib/presentation/views/home_view.dart \\
  quran_vocab/lib/presentation/views/reader_view.dart \\
  quran_vocab/lib/presentation/views/dashboard_view.dart \\
  quran_vocab/lib/presentation/views/review_view.dart \\
  quran_vocab/lib/presentation/views/curriculum_view.dart \\
  quran_vocab/lib/presentation/views/lesson_detail_view.dart
git commit -m "feat: revamp primary screens"
```

---

### Task 6: Manual visual verification

Run:
```
/Users/salmaanrauf/Documents/arabicapp/arabicvocab/tools/flutter/bin/flutter run \\
  -d web-server --web-port 8080 --web-hostname 0.0.0.0
```

Check:
- Theme toggle switches entire app.
- Dark mode uses Warm Noir styling.
- Light mode uses Parchment styling.
- Arabic text remains legible and clean.

---

### Task 7: Update documentation

**Files:**
- Update: `docs/implementation-guide.md`

Add a summary of the UI system and theme toggle behavior (already started).

Commit:
```
git add docs/implementation-guide.md
git commit -m "docs: add ui design system"
```

